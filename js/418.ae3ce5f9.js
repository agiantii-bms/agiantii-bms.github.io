"use strict";(self["webpackChunkbook_manage_system"]=self["webpackChunkbook_manage_system"]||[]).push([[418],{3418:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search_container"},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",[t._v("首页")]),e("el-breadcrumb-item",[t._v("发布公告")])],1),e("el-card",{attrs:{shadow:"always"}},[e("el-row",[e("el-col",{attrs:{span:4}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showAddDialog()}}},[e("i",{staticClass:"el-icon-s-promotion"}),t._v(" 发布新公告")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:"","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e("el-table-column",{attrs:{prop:"noticeId",label:"ID"}}),e("el-table-column",{attrs:{prop:"noticeTitle",label:"标题"}}),e("el-table-column",{attrs:{prop:"noticeContent",label:"公告"}}),e("el-table-column",{attrs:{prop:"createTime",label:"发布日期"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(e){return t.showEditDialog(i.row.noticeId)}}})],1),e("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.removeUserById(i.row.noticeId)}}})],1)]}}])})],1),e("el-pagination",{attrs:{"current-page":t.queryInfo.pageNum,"page-sizes":[1,2,3,4,5],"page-size":t.queryInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),e("el-dialog",{attrs:{title:"修改公告",visible:t.editDialogVisible,width:"50%"},on:{"update:visible":function(e){t.editDialogVisible=e},close:t.editDialogClosed}},[e("el-form",{ref:"editFormRef",attrs:{model:t.editForm,rules:t.editFormRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"公告标题",prop:"noticeTitle"}},[e("el-input",{model:{value:t.editForm.noticeTitle,callback:function(e){t.$set(t.editForm,"noticeTitle",e)},expression:"editForm.noticeTitle"}})],1),e("el-form-item",{attrs:{label:"公告内容",prop:"noticeContent"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.editForm.noticeContent,callback:function(e){t.$set(t.editForm,"noticeContent",e)},expression:"editForm.noticeContent"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.editNoticeById}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"添加公告",visible:t.addDialogVisible,width:"50%"},on:{"update:visible":function(e){t.addDialogVisible=e},close:t.addDialogClosed}},[e("el-form",{ref:"addFormRef",attrs:{model:t.addForm,rules:t.addFormRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"公告标题",prop:"noticeTitle"}},[e("el-input",{model:{value:t.addForm.noticeTitle,callback:function(e){t.$set(t.addForm,"noticeTitle",e)},expression:"addForm.noticeTitle"}})],1),e("el-form-item",{attrs:{label:"公告内容",prop:"noticeContent"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.addForm.noticeContent,callback:function(e){t.$set(t.addForm,"noticeContent",e)},expression:"addForm.noticeContent"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.addDialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.addNotice}},[t._v("添加公告")])],1)],1)],1)],1)},a=[],s=i(5941),n={data(){return{tableData:[],editDialogVisible:!1,editForm:{noticeTitle:"",noticeContent:""},editFormRules:{noticeTitle:[{required:!0,message:"请输入公告标题",trigger:"blur"},{min:6,max:30,message:"长度在6到30个字符",trigger:"blur"}],noticeContent:[{required:!0,message:"请输入公告内容",trigger:"blur"}]},addDialogVisible:!1,addForm:{noticeTitle:"",noticeContent:"",noticeAdminId:0},addFormRules:{noticeTitle:[{required:!0,message:"请输入公告标题",trigger:"blur"},{min:6,max:30,message:"长度在6到30个字符",trigger:"blur"}],noticeContent:[{required:!0,message:"请输入公告内容",trigger:"blur"}]},queryInfo:{pageNum:1,pageSize:5},total:0,loading:!0}},methods:{handleSizeChange(t){this.queryInfo.pageSize=t,this.getNoticeList()},handleCurrentChange(t){this.queryInfo.pageNum=t,this.getNoticeList()},async showEditDialog(t){this.loading=!0;const{data:e}=await this.$http.get("bookadmin/get_notice/"+t);if(200!==e.status)return this.$message.error(e.msg);this.editForm=e.data,this.editDialogVisible=!0},editDialogClosed(){this.$refs.editFormRef.resetFields()},async editNoticeById(){const{data:t}=await this.$http.put("bookadmin/update_notice/"+this.editForm.noticeId,{noticeTitle:this.editForm.noticeTitle,noticeContent:this.editForm.noticeContent});if(200!==t.status)return this.$message.error(t.msg);this.editDialogVisible=!1,this.getNoticeList(),this.$message.success(t.msg)},async removeUserById(t){const e=await this.$confirm("此操作将永久删除该公告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((t=>t));if("confirm"!==e)return this.$message.info("已经取消删除");const{data:i}=await this.$http.get("bookadmin/delete_notice/"+t);if(200!==i.status)return this.$message.error(i.msg);this.$message.success({message:i.msg,duration:1500}),this.getNoticeList()},addDialogClosed(){this.$refs.addFormRef.resetFields()},showAddDialog(){this.addDialogVisible=!0},async getNoticeList(){this.loading=!0;const{data:t}=await this.$http.post("bookadmin/get_noticelist",this.queryInfo);if(this.tableData=[],200!==t.status)return this.total=0,this.loading=!1,this.$message.error(t.msg);this.$message.success({message:t.msg,duration:1e3}),this.tableData=t.data.records,this.total=parseInt(t.data.total),this.loading=!1},async addNotice(){this.addDialogVisible=!1,this.addForm.noticeAdminId=parseInt(window.sessionStorage.getItem("bookAdminId"));const{data:t}=await this.$http.post("bookadmin/add_notice",this.addForm);if(s.log(t),200!==t.status)return this.$message.error(t.msg);this.$message.success({message:t.msg,duration:1e3}),this.getNoticeList()}},created(){this.getNoticeList()}},l=n,r=i(1001),d=(0,r.Z)(l,o,a,!1,null,null,null),c=d.exports}}]);
//# sourceMappingURL=418.ae3ce5f9.js.map