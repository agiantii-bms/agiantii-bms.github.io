{"version":3,"file":"js/835.2fa5cb88.js","mappings":"gLAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,KAAK,CAACG,YAAY,CAAC,aAAa,SAAS,MAAQ,gBAAgB,CAACL,EAAIM,GAAG,mBAAmBJ,EAAG,UAAU,CAACE,YAAY,OAAOC,YAAY,CAAC,aAAa,OAAO,OAAS,OAAO,gBAAgB,OAAO,eAAe,SAAS,CAACH,EAAG,UAAU,CAACE,YAAY,aAAaJ,EAAIO,GAAIP,EAAIQ,UAAU,SAASC,GAAM,OAAOP,EAAG,MAAM,CAACQ,IAAIV,EAAIW,QAAQC,GAAGR,YAAY,WAAW,CAAqB,MAAnBK,EAAKI,cAAwC,KAApBJ,EAAKI,aAAmBX,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACJ,EAAIM,GAAG,IAAIN,EAAIc,GAAGL,EAAKI,cAAc,OAAOb,EAAIe,KAAqB,MAAfN,EAAKO,UAAgC,KAAhBP,EAAKO,SAAed,EAAG,MAAM,CAACE,YAAY,eAAe,CAACJ,EAAIM,GAAGN,EAAIc,GAAGL,EAAKO,aAAahB,EAAIe,MAAM,IAAG,GAAGb,EAAG,WAAW,CAACe,MAAM,CAAC,YAAc,2BAA2B,SAAWjB,EAAIkB,SAASC,SAAS,CAAC,MAAQ,SAASC,GAAQ,OAAIA,EAAOC,KAAKC,QAAQ,QAAQtB,EAAIuB,GAAGH,EAAOI,QAAQ,QAAQ,GAAGJ,EAAOV,IAAI,SAAgB,KAAYV,EAAIyB,YAAYC,MAAM,KAAMC,UAAU,GAAGC,MAAM,CAACC,MAAO7B,EAAIa,aAAciB,SAAS,SAAUC,GAAM/B,EAAIa,aAA6B,kBAARkB,EAAkBA,EAAIC,OAAQD,CAAI,EAAEE,WAAW,iBAAiB,CAAC/B,EAAG,YAAY,CAACgC,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYP,MAAO7B,EAAIkB,QAASe,WAAW,YAAYhB,MAAM,CAAC,KAAO,SAAS,KAAO,sBAAsB,SAAWjB,EAAIkB,SAASmB,GAAG,CAAC,MAAQrC,EAAIyB,aAAaa,KAAK,YAAY,IAAI,IAAI,EAC92C,EACIC,EAAkB,GC+BtB,G,QAAA,CACAC,OACA,OACAhC,SAAAA,GACAK,aAAAA,GACAF,QAAAA,CACAE,aAAAA,GACAG,SAAAA,GACAyB,OAAAA,MAEAvB,SAAAA,EAEA,EACAwB,QAAAA,CAKA,oBAEA,iCACA,2BACA/B,QAAAA,SACAgC,SAAAA,OAIA,wCACA,oBACAhC,QAAAA,cACAgC,SAAAA,WAIA,kCACA,8CACA,oBACA/B,GAAAA,KAAAA,MACAC,aAAAA,KAAAA,aACA4B,OAAAA,SAAAA,KAGA,mDACA,sBAEA,qBACA,gBACA,oBACA9B,QAAAA,6BACAgC,SAAAA,OAEA,MAAAH,KAAAA,SAAA,oDAEA,kBAEA,OADA,gBACA,2BAEA,uBACA7B,QAAAA,EAAAA,IACAgC,SAAAA,OAEA,oBACA/B,GAAAA,KAAAA,MACAI,SAAAA,EAAAA,KACAyB,OAAAA,IAEA,eAEA,CACA,EAKA,0BACA,8CACA,MAAAD,KAAAA,SAAA,8CACA,kBACA,kCAEA,uBACA7B,QAAAA,EAAAA,IACAgC,SAAAA,OAEAC,EAAAA,KAAAA,SAAAA,IACA,wBAEA,GAEAC,UACA,wBACA,IC5HoQ,I,UCQhQC,GAAY,OACd,EACA/C,EACAwC,GACA,EACA,KACA,WACA,MAIF,EAAeO,EAAiB,O","sources":["webpack://book_manage_system/./src/components/User/Intelligent.vue","webpack://book_manage_system/src/components/User/Intelligent.vue","webpack://book_manage_system/./src/components/User/Intelligent.vue?2207","webpack://book_manage_system/./src/components/User/Intelligent.vue?d620"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"chat-container\"},[_c('h2',{staticStyle:{\"text-align\":\"center\",\"color\":\"deepskyblue\"}},[_vm._v(\"AI 智能推荐 by小白条\")]),_c('el-card',{staticClass:\"chat\",staticStyle:{\"margin-top\":\"10px\",\"height\":\"80vh\",\"border-radius\":\"15px\",\"border-color\":\"#ccc\"}},[_c('el-card',{staticClass:\"main_chat\"},_vm._l((_vm.messages),function(item){return _c('div',{key:_vm.message.id,staticClass:\"message\"},[(item.inputMessage!=null&&item.inputMessage!=='')?_c('div',{staticClass:\"user-message\"},[_vm._v(\" \"+_vm._s(item.inputMessage)+\" \")]):_vm._e(),(item.aiResult!=null&&item.aiResult!=='')?_c('div',{staticClass:\"bot-message\"},[_vm._v(_vm._s(item.aiResult))]):_vm._e()])}),0),_c('el-input',{attrs:{\"placeholder\":\"请输入内容，例如：我喜欢动物类的书籍，请给我推荐\",\"disabled\":_vm.loading},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.sendMessage.apply(null, arguments)}},model:{value:(_vm.inputMessage),callback:function ($$v) {_vm.inputMessage=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"inputMessage\"}},[_c('el-button',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],attrs:{\"slot\":\"append\",\"icon\":\"el-icon-s-promotion\",\"disabled\":_vm.loading},on:{\"click\":_vm.sendMessage},slot:\"append\"})],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"chat-container\">\r\n    <h2 style=\"text-align: center;color:deepskyblue;\">AI 智能推荐 by小白条</h2>\r\n    <el-card class=\"chat\" style=\"margin-top:10px;height: 80vh;border-radius: 15px;border-color: #ccc;\">\r\n      <el-card class=\"main_chat\">\r\n        <div v-for=\"item in messages\" :key=\"message.id\" class=\"message\">\r\n          <div v-if=\"item.inputMessage!=null&&item.inputMessage!==''\" class=\"user-message\">\r\n            {{ item.inputMessage }}\r\n          </div>\r\n          <div v-if=\"item.aiResult!=null&&item.aiResult!==''\" class=\"bot-message\">{{ item.aiResult }}</div>\r\n        </div>\r\n\r\n      </el-card>\r\n      <el-input\r\n          placeholder=\"请输入内容，例如：我喜欢动物类的书籍，请给我推荐\"\r\n          v-model.trim=\"inputMessage\"\r\n          :disabled=\"loading\"\r\n          @keyup.enter.native=\"sendMessage\"\r\n      >\r\n        <el-button\r\n            slot=\"append\"\r\n            icon=\"el-icon-s-promotion\"\r\n            v-loading=\"loading\"\r\n            @click=\"sendMessage\"\r\n            :disabled=\"loading\"\r\n        ></el-button>\r\n      </el-input\r\n      >\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      messages: [],\r\n      inputMessage: \"\",\r\n      message: {\r\n        inputMessage: \"\",\r\n        aiResult: \"\",\r\n        userId: null\r\n      },\r\n      loading: false\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n     * 发送消息，接受AI结果\r\n     * @returns {Promise<ElMessageComponent>}\r\n     */\r\n    async sendMessage() {\r\n      // 将用户输入的消息添加到消息列表中\r\n      if (this.inputMessage.trim() === \"\") {\r\n        return this.$message.info({\r\n          message: \"文本不能为空\",\r\n          duration: 1500\r\n        })\r\n      }\r\n      // 先判断文本内容是否为空或者是无意义的数字，如果是提示用户信息\r\n      if (/[\\da-zA-Z]/.test(this.inputMessage)) {\r\n        this.$message.info({\r\n          message: \"请不要输入无意义的内容\",\r\n          duration: 1000\r\n        });\r\n        return;\r\n      }\r\n      if (this.inputMessage.trim() !== \"\") {\r\n        var userId = window.sessionStorage.getItem(\"userId\");\r\n        this.messages.push({\r\n          id: Date.now(),\r\n          inputMessage: this.inputMessage,\r\n          userId: parseInt(userId)\r\n        });\r\n        // 这里可以是调用 GPT API 的逻辑\r\n        this.message.inputMessage = this.inputMessage.trim();\r\n        this.message.userId = userId;\r\n        // 清空输入框\r\n        this.inputMessage = \"\";\r\n        this.loading = true;\r\n        this.$message.info({\r\n          message:\"文本输入越长，接口调用时间越长，请耐心等待10秒左右\",\r\n          duration:2500\r\n        })\r\n        const {data: res} = await this.$http.post(\"user/ai_intelligent\", this.message)\r\n\r\n        if (res.status !== 200) {\r\n          this.loading = false;\r\n          return this.$message.error(res.msg);\r\n        }\r\n        this.$message.success({\r\n          message: res.msg,\r\n          duration: 1500\r\n        })\r\n        this.messages.push({\r\n          id: Date.now(),\r\n          aiResult: res.data,\r\n          userId: userId\r\n        });\r\n        this.loading = false;\r\n\r\n      }\r\n    },\r\n    /**\r\n     * 获取最近五条该用户和AI交流的信息\r\n     * @returns {Promise<void>}\r\n     */\r\n    async getHistoryRecords() {\r\n      var userId = window.sessionStorage.getItem(\"userId\");\r\n      const {data: res} = await this.$http.get(\"user/ai_list_information/\" + userId)\r\n      if (res.status !== 200) {\r\n        return this.$message.error(res.msg)\r\n      }\r\n      this.$message.success({\r\n        message: res.msg,\r\n        duration: 1500\r\n      })\r\n      res.data.forEach((item) => {\r\n        this.messages.push(item);\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.getHistoryRecords();\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang='less'>\r\n//.chat-container {\r\n//  display: flex;\r\n//  flex-direction: column;\r\n//  height: 100vh;\r\n//}\r\n.main_chat {\r\n  margin-bottom: 10px;\r\n  height: 70vh;\r\n  background-size: cover;\r\n  background: url(https://xxx.xiaobaitiao.icu/img/icu/202312211243632.jpg) no-repeat 0px 0px;\r\n  border-radius: 10px;\r\n  overflow-y: scroll;\r\n}\r\n\r\n.message {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.user-message {\r\n  display: flex;\r\n  flex-direction: row;\r\n  background-color: #e7f7ff;\r\n  padding: 10px;\r\n  border-radius: 10px;\r\n  align-self: flex-end;\r\n  text-align: right;\r\n  margin-top: 10px;\r\n\r\n}\r\n\r\n.bot-message {\r\n  background-color: #f4f6f8;\r\n  padding: 10px;\r\n  border-radius: 10px;\r\n  text-align: left;\r\n  align-self: flex-start;\r\n  margin-top: 10px;\r\n  white-space: pre-wrap;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Intelligent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Intelligent.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Intelligent.vue?vue&type=template&id=7680cbfa&scoped=true&\"\nimport script from \"./Intelligent.vue?vue&type=script&lang=js&\"\nexport * from \"./Intelligent.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Intelligent.vue?vue&type=style&index=0&id=7680cbfa&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7680cbfa\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","staticStyle","_v","_l","messages","item","key","message","id","inputMessage","_s","_e","aiResult","attrs","loading","nativeOn","$event","type","indexOf","_k","keyCode","sendMessage","apply","arguments","model","value","callback","$$v","trim","expression","directives","name","rawName","on","slot","staticRenderFns","data","userId","methods","duration","res","created","component"],"sourceRoot":""}