"use strict";(self["webpackChunkbook_manage_system"]=self["webpackChunkbook_manage_system"]||[]).push([[273],{8273:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"intelligent_analysis"},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-card",{attrs:{header:"智能分析"}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px",enctype:"multipart/form-data"}},[t("el-form-item",{attrs:{label:"分析目标: ",prop:"goal"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.goal,callback:function(t){e.$set(e.form,"goal",t)},expression:"form.goal"}})],1),t("el-form-item",{attrs:{label:"图表名称: ",prop:"name"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"图表类型: ",prop:"chartType"}},[t("el-select",{attrs:{placeholder:"请选择图表类型"},model:{value:e.form.chartType,callback:function(t){e.$set(e.form,"chartType",t)},expression:"form.chartType"}},[t("el-option",{attrs:{label:"折线图",value:"折线图"}}),t("el-option",{attrs:{label:"柱状图",value:"柱状图"}}),t("el-option",{attrs:{label:"堆叠图",value:"堆叠图"}}),t("el-option",{attrs:{label:"饼图",value:"饼图"}}),t("el-option",{attrs:{label:"雷达图",value:"雷达图"}})],1)],1),t("el-form-item",{attrs:{label:"原始数据: "}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","on-remove":e.handleRemove,"on-change":e.handleChange,multiple:"",limit:1,"on-exceed":e.handleExceed,name:"file","file-list":e.fileList,"auto-upload":!1}},[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-upload2"}},[e._v("上传Excel文件")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传xls/xlsx文件，且不超过1MB ")])],1)],1),t("el-form-item",[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.submitting,expression:"submitting"}],attrs:{type:"primary",disabled:e.submitting},on:{click:e.onSubmit}},[e._v("提交")]),t("el-button",{attrs:{disabled:e.submitting},on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.submitting,expression:"submitting"}],attrs:{header:"分析结论"}},[e.chart.genResult?t("div",{staticStyle:{"white-space":"pre-wrap"}},[e._v(" "+e._s(e.chart.genResult)+" ")]):t("div",[e.submitting?e._e():t("div",[e._v("请先在左侧进行提交")])])]),t("el-divider"),t("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.submitting,expression:"submitting"}],attrs:{header:"可视化图表"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.chart.genChart,expression:"chart.genChart"}]},[t("div",{ref:"chartContainer",staticClass:"chartContainer",staticStyle:{width:"100%",height:"50vh"}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.chart.genChart,expression:"!chart.genChart"}]},[e.submitting?e._e():t("div",{on:{click:function(t){return e.createChart()}}},[e._v(" 请先在左侧进行提交 ")])])])],1)],1)],1)},i=[],r=a(3805),l={data(){return{form:{goal:"",name:"",chartType:"",adminId:void 0},file:{},rules:{goal:[{required:!0,message:"请输入分析目标",trigger:"blur"},{min:5,max:100,message:"长度在 5 到 100 个字符",trigger:"blur"}]},chart:{genChart:"",genResult:"",chartId:""},resultChart:{},fileList:[],submitting:!1}},methods:{handleExceed(e,t){this.$message.info({message:"最多只能上传一个文件",duration:1500})},handleChange(e,t){const a=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];if(-1===a.indexOf(e.raw.type))return this.$message.info({message:"只允许xls或者xlsx格式的文件上传",duration:1500}),void this.handleRemove(e);const s=1048576;if(e.raw.size>s)return this.$message.info({message:"只允许文件大小在1MB之内的Excel文件",duration:1500}),void this.handleRemove(e);this.file=e.raw},async onSubmit(){if(this.submitting)return;this.submitting=!0;const e=new FormData;this.file&&e.append("file",this.file),this.form.adminId=parseInt(window.sessionStorage.getItem("adminId"));for(const a in this.form)e.append(a,this.form[a]);this.$message.info({message:"接口调用花费时间在30秒左右，AI模型暂时不稳定",duration:2500});const{data:t}=await this.$http.post("/admin/gen",e,{headers:{"Content-Type":"multipart/form-data"}});if(200!==t.status)return this.submitting=!1,this.$message.error({message:t.msg,duration:1500});this.chart=t.data,this.resultChart=t.map.genChart,this.createChart(),this.$message.success({message:t.msg,duration:1500}),this.submitting=!1},createChart(){const e=this.resultChart;if(!e)return this.$message.error({message:"图表代码解析错误",duration:1500});this.$nextTick((()=>{const t=r.init(this.$refs.chartContainer);t.setOption(e)}))},resetForm(){this.$refs.form.resetFields(),this.handleRemove()},handleRemove(e,t){this.fileList=t,this.fileList=[],this.file={}}},mounted(){}},n=l,o=a(1001),m=(0,o.Z)(n,s,i,!1,null,"f04b0d60",null),d=m.exports}}]);
//# sourceMappingURL=273.88e1cb7c.js.map