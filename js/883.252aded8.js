"use strict";(self["webpackChunkbook_manage_system"]=self["webpackChunkbook_manage_system"]||[]).push([[883],{9883:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"search_container"},[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[e._v("首页")]),t("el-breadcrumb-item",[e._v("借阅证管理")])],1),t("el-card",{attrs:{shadow:"always"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:6}},[e._v("条件搜索:"),t("el-select",{staticStyle:{"margin-left":"15px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.queryInfo.condition,callback:function(t){e.$set(e.queryInfo,"condition",t)},expression:"queryInfo.condition"}},e._l(e.searchs,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-col",{attrs:{span:4}},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getStatementList.apply(null,arguments)}},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getStatementList},slot:"append"})],1)],1),t("el-col",{attrs:{span:4}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showAddDialog()}}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 添加借阅证")])],1),t("el-col",{staticStyle:{float:"right"},attrs:{span:2}},[t("download-excel",{staticClass:"export-excel-wrapper",attrs:{data:e.tableData,fields:e.json_fields,header:e.title,name:"借阅证管理.xls"}},[t("el-button",{staticClass:"el-icon-printer",attrs:{type:"primary",size:"mini"}},[e._v("导出Excel")])],1)],1),t("el-col",{staticStyle:{float:"right"},attrs:{span:2}},[t("el-button",{staticClass:"el-icon-printer",attrs:{type:"primary",size:"mini"},on:{click:e.downLoad}},[e._v("导出PDF")])],1),t("el-col",{staticStyle:{float:"right"},attrs:{span:2}},[t("el-button",{staticClass:"el-icon-full-screen",attrs:{type:"success",size:"mini"},on:{click:e.fullScreen}},[e._v("全屏")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"",id:"pdfDom","default-sort":{prop:"cardNumber",order:"ascending"},"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[t("el-table-column",{attrs:{prop:"cardNumber",label:"借阅证编号",sortable:""}}),t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"ruleNumber",label:"借阅规则",sortable:""}}),t("el-table-column",{attrs:{prop:"status",label:"状态",sortable:""}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.showEditDialog(a.row.userId)}}})],1),t("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.removeUserById(a.row.userId)}}})],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.queryInfo.pageNum,"page-sizes":[1,2,3,4,5],"page-size":e.queryInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:"修改书籍",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[t("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"账号",prop:"username"}},[t("el-input",{model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password",t)},expression:"editForm.password"}})],1),t("el-form-item",{attrs:{label:"规则",prop:"ruleNumber"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.ruleNumber,callback:function(t){e.$set(e.editForm,"ruleNumber",t)},expression:"editForm.ruleNumber"}},e._l(e.bookRuleIdLists,(function(e){return t("el-option",{key:e.ruleId,attrs:{label:e.bookRuleId,value:e.bookRuleId}})})),1)],1),t("el-form-item",{attrs:{label:"状态",prop:"userStatus"}},[t("el-radio-group",{model:{value:e.editForm.userStatus,callback:function(t){e.$set(e.editForm,"userStatus",t)},expression:"editForm.userStatus"}},[t("el-radio",{attrs:{label:"可用"}},[e._v("可用")]),t("el-radio",{attrs:{label:"挂失"}},[e._v("挂失")])],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.updateStatement}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加借书证",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[t("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"账号",prop:"username"}},[t("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),t("el-form-item",{attrs:{label:"规则",prop:"ruleNumber"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.ruleNumber,callback:function(t){e.$set(e.addForm,"ruleNumber",t)},expression:"addForm.ruleNumber"}},e._l(e.bookRuleIdLists,(function(e){return t("el-option",{key:e.ruleId,attrs:{label:e.bookRuleId,value:e.bookRuleId}})})),1)],1),t("el-form-item",{attrs:{label:"状态",prop:"userStatus"}},[t("el-radio-group",{model:{value:e.addForm.userStatus,callback:function(t){e.$set(e.addForm,"userStatus",t)},expression:"addForm.userStatus"}},[t("el-radio",{attrs:{label:"可用"}},[e._v("可用")]),t("el-radio",{attrs:{label:"禁用"}},[e._v("禁用")])],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addStatement}},[e._v("添加借阅证")])],1)],1)],1)],1)},l=[],r=a(5941),o={data(){return{tableData:[],editDialogVisible:!1,editForm:{username:"",password:"",ruleNumber:"",status:"",userStatus:""},editFormRules:{},addDialogVisible:!1,addForm:{username:"",password:"",ruleNumber:"",userStatus:""},addFormRules:{},searchs:[{value:"card_number",label:"借阅证编号"},{value:"username",label:"用户名"},{value:"rule_number",label:"借阅规则"},{value:"status",label:"状态"}],bookRuleIdLists:[{ruleId:"18",bookRuleId:"18"},{ruleId:"357",bookRuleId:"357"}],queryInfo:{pageNum:1,pageSize:5,condition:"",query:""},total:0,title:"借阅证管理",json_fields:{"借阅证遍号":"cardNumber","用户名":"username","借阅规则":"ruleNumber","状态":"status"},loading:!0}},methods:{handleSizeChange(e){this.queryInfo.pageSize=e,this.getStatementList()},handleCurrentChange(e){this.queryInfo.pageNum=e,this.getStatementList()},async showEditDialog(e){const{data:t}=await this.$http.get("admin/get_statement/"+e);if(200!==t.status)return this.$message.error(t.msg);const{data:a}=await this.$http.get("user/get_rulelist");this.bookRuleIdLists=a.data,this.editForm=t.data,this.editDialogVisible=!0},editDialogClosed(){this.$refs.editFormRef.resetFields(),this.editForm.checkList=["南图","北图","教师之家"]},async removeUserById(e){const t=await this.$confirm("此操作将永久删除该书籍, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已经取消删除");const{data:a}=await this.$http.delete("admin/delete_statement/"+e);if(r.log(a),200!==a.status)return this.$message.error(a.msg);this.$message.success(a.msg),this.getStatementList()},addDialogClosed(){this.$refs.addFormRef.resetFields()},async showAddDialog(){const{data:e}=await this.$http.get("user/get_rulelist");this.bookRuleIdLists=e.data,this.addDialogVisible=!0},async getStatementList(){this.loading=!0;const{data:e}=await this.$http.post("admin/get_statementlist",this.queryInfo);if(this.tableData=[],200!==e.status)return this.total=0,this.loading=!1,this.$message.error(e.msg);this.$message.success({message:e.msg,duration:1e3}),this.tableData=e.data.records,this.total=parseInt(e.data.total),this.loading=!1},async addStatement(){const{data:e}=await this.$http.post("admin/add_statement",this.addForm);if(200!==e.status)return this.$message.error(e.msg);this.$message.success(e.msg),this.addDialogVisible=!1,this.getStatementList()},async updateStatement(){const{data:e}=await this.$http.post("admin/update_statement",this.editForm);if(200!==e.status)return this.$message.error(e.msg);this.$message.success(e.msg),this.getStatementList(),this.editDialogVisible=!1},downLoad(){this.getPdf(this.title)},fullScreen(){let e=document.fullscreenElement;e?document.exitFullscreen():document.documentElement.requestFullscreen()}},created(){this.getStatementList()}},i=o,n=a(1001),d=(0,n.Z)(i,s,l,!1,null,null,null),u=d.exports}}]);
//# sourceMappingURL=883.252aded8.js.map